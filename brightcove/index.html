<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>BrightCove Sample</title>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/@contentstack/ui-extensions-sdk@2.1.2/dist/ui-extension-sdk.css">
    <script src="https://unpkg.com/@contentstack/ui-extensions-sdk@2.1.2/dist/ui-extension-sdk.js"></script>
    <style media="all">
.wrapper{margin:0;padding:0;width:100%}.wrapper .container{width:1200px;margin:0 auto;overflow:hidden}.wrapper .container .discription_box{width:100%;float:left}.discription_box ul{width:100%;float:left;display:block;padding-bottom:25px}.discription_box ul li[id]{width:30.33%;float:left;display:block;margin-right:3%;border:1px solid #ccc}.discription_box ul li img{width:100%;height:auto;position:relative}.discription_box ul li span{font-size:14px;line-height:20px;display:block;border-radius:32px}.discription_box ul li span.title{font-size:16px;line-height:20px;padding:10px 10px 5px;display:block;color:#748590}.discription_box ul li p{font-size:12px;line-height:14px;padding:0 10px 20px;margin-bottom:0;color:#748590}.discription_box ul li{position:relative;display:block}.discription_box .choose_video{border:1px solid #25c2a3;border-radius:24px;font-size:14px;line-height:1.42857143;padding:5px 15px;display:inline-block;text-align:center;text-decoration:none;color:#25c2a3}.wrapper .container .list_section{width:100%;display:none;float:left}.wrapper .container .list_section form{padding-top:20px}.list_section ul{width:100%;float:left;display:block;padding-top:35px;padding-bottom:25px}.list_section ul li{width:28.33%;float:left;display:block;margin-right:4.2%;border:1px solid transparent;margin-bottom:19px}.list_section ul li:nth-child(3n+3){margin-right:0}.list_section ul li section{position:relative;display:block;height:150px;width:100%}.list_section ul li section img{width:100%;height:100%;position:relative;cursor:default}.list_section ul li span.title{font-size:16px;line-height:20px;padding:10px 10px 5px;display:block;color:#748590}.list_section ul li p{font-size:12px;line-height:14px;padding:0 10px 20px;margin-bottom:0;color:#748590}.list_section ul li.selected{position:relative;border:1px solid #4895e6}.list_section ul li.selected:after{width:8px;position:absolute;content:'';right:15px;top:7px;height:8px;border-radius:50%;border:7px solid #4895e6;background:#fff}@media (max-width:1200px){.wrapper .container{width:100%}.list_section ul li{margin-right:4%;cursor:pointer}}.list_section ul li:nth-child(3n+3){margin-right:4%}.reference-loading{width:50%}.reference-loading .loader,.reference-loading .loader:after,.reference-loading .loader:before{border-radius:50%;width:1.3em;height:1.3em;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation:load7 1.8s infinite ease-in-out;animation:load7 1.8s infinite ease-in-out}.reference-loading .loader{color:#25c2a3;font-size:10px;position:relative;text-indent:-9999em;-webkit-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0);-webkit-animation-delay:-.16s;animation-delay:-.16s;top:-20px;margin-left:6%}.reference-loading .loader:after,.reference-loading .loader:before{content:'';position:absolute;top:0}.reference-loading .loader:before{left:-2.5em;-webkit-animation-delay:-.32s;animation-delay:-.32s}.reference-loading .loader:after{left:2.5em}.msg{display:none;padding-left:20px}.list_section ul li a img{width:100%;height:150px;position:relative}.discription_box ul li img{width:100%;height:150px;position:relative;cursor:default}.reference-loading{display:inline-block;margin-left:50px}@-webkit-keyframes load7{0%,100%,80%{box-shadow:0 2.5em 0 -1.3em}40%{box-shadow:0 2.5em 0 0}}@keyframes load7{0%,100%,80%{box-shadow:0 2.5em 0 -1.3em}40%{box-shadow:0 2.5em 0 0}}.reference-loading .loading{text-align:center;margin:20px auto}.reference-loading .loading-flash div{border-radius:50%;height:10px;width:10px;display:inline-block;box-sizing:border-box;background:#25c2a3}.reference-loading .loading-flash div:nth-of-type(4){animation:flash .4s .5s ease-in-out infinite}.reference-loading .loading-flash div:nth-of-type(3){animation:flash .4s .2s linear infinite}.reference-loading .loading-flash div:nth-of-type(2){animation:flash .4s -.1s linear infinite}.reference-loading .loading-flash div:nth-of-type(1){animation:flash .4s -.4s linear infinite}@keyframes flash{0%{opacity:0}50%{opacity:.5}100%{opacity:1}}body{overflow:hidden}.msg{display:none;padding:20px}.loader{display:none}.discription_box ul li img{width:100%;height:auto;position:relative;max-height:150px}.choose_video{cursor:pointer}.load-spinner>div>span{display:inline-block;margin-right:7px;background-image:url(https://images.contentstack.io/v3/assets/bltd1343376dfba54d2/blta0b4f830d61ba527/5b58019b4f5e9b551d22f4f9/loading.gif);background-size:100%;background-color:#8a2be200;background-repeat:no-repeat;width:15px;height:15px;background-position:0 0;line-height:20px;text-align:center;position:relative;top:2px}.load-more{width:100%;border:0;clear:both;font-size:14px;text-align:center;cursor:pointer;box-sizing:border-box;display:block;float:left}.load-more>div{border:1px solid #e6eced;background:#fff;color:#748590!important;white-space:normal;padding:6px 20px;cursor:pointer;font-weight:600;border-radius:2px;font-size:14px;line-height:1.42857143;text-align:center;text-decoration:none;display:block;margin:0 30px}.total-count{display:none}
</style>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</head>

<body>
    <div class="wrapper">
        <div class="container">
            <div class="discription_box">
                <ul>
                    <li>
                        <span>No Video Selected</span>
                    </li>
                </ul>
                <div class="choose_video">Choose Video</div>
            </div>
            <div class="reference-loading">
                <div class="loading-flash">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
            <!-- list section start  here -->
            <div class="list_section">

                <form action>
                    <input type="search" class="cs-text-box w-100 searchInpput" placeholder="Search...">

                </form>
                <div class="loader">
                    <img id="loader-img" alt="loader" src="https://clinicalpulse.com/img/loading.gif" width="100" height="100" align="center">
                </div>
                <div class="msg">No Videos Found</div>
                <ul id="products">
                </ul>

                <div class="load-more" id="load-more-button" onclick="loadMore()">
                    <div>
                        <span></span>Load More</div>
                </div>
                <label class="total-count"></label>
            </div>
            <!-- list section ends  here -->
        </div>
    </div>

    <script>
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var extensionField,loader,unorderedList,msg,initialList,totalVideos,loadMoreBtn,request={},offset=0,limit=20;function render(e,t){var n,i;msg.hide(),e.forEach(function(e,t){"ACTIVE"===e.state&&(n=(e.images.thumbnail||e.images.poster).src,i=e.description||"",unorderedList.append("<li id='".concat(e.id,"'>\n                <section class=\"img-wrapper\"><img src='").concat(n,'\' alt="image-6"></section>\n                 <span class="title"> ').concat(e.name,"</span> \n                <p>").concat(i,"</p></li>")))});e=extensionField&&extensionField.field&&extensionField.field.getData()?extensionField.field.getData():null;e&&(e.includes("blt")&&(e=e.replace("blt","")),$(".discription_box ul").empty(),request.getInitialVideo(e).then(function(e){n=(e.images.thumbnail||e.images.poster).src,i=e.description||"",$(".discription_box ul").append("<li id='".concat(e.id,"'>\n                <section class=\"img-wrapper\"><img src='").concat(n,'\' alt="image-6"></section>\n                <span class="title">').concat(e.name,"</span>\n                <p>").concat(i,"</p></li>"))}),$(".discription_box ul li a").click(function(e){e.preventDefault()}),setTimeout(function(){t||extensionField.window.updateHeight()},1e3)),$(".list_section ul li").length===parseInt(totalVideos.text())||$(".list_section ul li").length>=parseInt(totalVideos.text())?loadMoreBtn.hide():loadMoreBtn.show(),$(".load-more").removeClass("load-spinner"),$(".discription_box").show(),$(".choose_video").click(function(e){$(".list_section").show()}),domChangeListner()}function domChangeListner(){var e=$(".list_section ul li");$(".list_section ul li section").click(function(e){e.preventDefault(),$(".list_section ul li").removeClass("selected"),$(this).parent().addClass("selected")}),e.click(function(){var e=$(this)[0].outerHTML;extensionField.field.setData($(this).attr("id")).then(function(){$(".discription_box ul").html(e),$(".list_section").hide()}).catch(function(e){console.log("error in setting data",e)})})}function loadMore(){loadMoreBtn.addClass("load-spinner"),offset+=limit,request.getBrightcoveVideos().then(function(e){loadMoreBtn.removeClass("loadspin"),render(e)})}function getData(t){return new Promise(function(n,i){var e,o=new XMLHttpRequest;for(e in o.open(t.method,t.url),loader.show(),t.headers)t.headers.hasOwnProperty(e)&&o.setRequestHeader(e,t.headers[e]);o.onload=function(e){var t;200==o.status?(loader.hide(),t=JSON.parse(o.response),n(t)):i(Error(o.statusText))},o.onerror=function(){i(Error("Network Error"))},t.data?o.send(t.data):o.send()})}$(document).ready(function(){msg=$(".msg"),loader=$(".reference-loading"),unorderedList=$(".list_section ul"),loadMoreBtn=$("#load-more-button"),totalVideos=$(".total-count"),$(".discription_box").hide(),ContentstackUIExtension.init().then(function(e){(request=new Request((extensionField=e).config)).getVideoCount().then(function(e){totalVideos.text(e.count),request.getBrightcoveVideos().then(function(e){render(initialList=e)})}),$(".searchInpput").on("keypress",function(e){var t=$(this).val().toLowerCase();if(offset=0,13==e.keyCode){if(e.preventDefault(),!t)return unorderedList.empty(),render(initialList,!0);request.search(t).then(function(e){return 0===e.length?(unorderedList.empty(),loadMoreBtn.hide(),loader.hide(),void msg.show()):(unorderedList.empty(),void render(e,!0))})}}),$(".searchInpput").on("keyup",function(e){var t=$(this).val().toLowerCase();if(offset=0,!t)return unorderedList.empty(),msg.hide(),render(initialList,!0)}),extensionField.window.enableAutoResizing()})});var Request=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getVideoCount",value:function(){var n={"Content-Type":"application/x-www-form-urlencoded"},i="client_id=".concat(extensionField.config.client_id,"&client_secret=").concat(extensionField.config.client_secret,"&grant_type=client_credentials"),o=extensionField.config.oauthUrl;return new Promise(function(t,e){getData({url:o,headers:n,method:"POST",data:i}).then(function(e){return e}).then(function(e){e={Authorization:"Bearer ".concat(e.access_token)};getData({url:extensionField.config.videocountUrl,headers:e,method:"GET"}).then(function(e){t(e)}).catch(function(e){throw e})})})}},{key:"getInitialVideo",value:function(i){var e={"Content-Type":"application/x-www-form-urlencoded"},o="client_id=".concat(extensionField.config.client_id,"&client_secret=").concat(extensionField.config.client_secret,"&grant_type=client_credentials"),c=extensionField.config.oauthUrl;return new Promise(function(t,n){getData({url:c,headers:e,method:"POST",data:o}).then(function(e){return e}).then(function(e){e={Authorization:"Bearer ".concat(e.access_token)};getData({url:"".concat(extensionField.config.brightcoveUrl,"/").concat(i),headers:e,method:"GET"}).then(function(e){t(e)}).catch(function(e){loader.hide(),msg.show()})}).catch(function(e){n(e)})})}},{key:"search",value:function(i){var e={"Content-Type":"application/x-www-form-urlencoded"},o="client_id=".concat(extensionField.config.client_id,"&client_secret=").concat(extensionField.config.client_secret,"&grant_type=client_credentials"),c=extensionField.config.oauthUrl;return new Promise(function(t,n){getData({url:c,headers:e,method:"POST",data:o}).then(function(e){return e}).then(function(e){e={Authorization:"Bearer ".concat(e.access_token)};getData({url:"".concat(extensionField.config.searchUrl).concat(i),headers:e,method:"GET"}).then(function(e){t(e)}).catch(function(e){console.log(e),loader.hide(),msg.show()})}).catch(function(e){n(e)})})}},{key:"getBrightcoveVideos",value:function(){var n={"Content-Type":"application/x-www-form-urlencoded"},i="client_id=".concat(extensionField.config.client_id,"&client_secret=").concat(extensionField.config.client_secret,"&grant_type=client_credentials"),o=extensionField.config.oauthUrl;return new Promise(function(t,e){getData({url:o,headers:n,method:"POST",data:i}).then(function(e){return e}).then(function(e){e={Authorization:"Bearer ".concat(e.access_token)};getData({url:"".concat(extensionField.config.brightcoveUrl,"?limit=").concat(limit,"&offset=").concat(offset),headers:e,method:"GET"}).then(function(e){t(e)}).catch(function(e){throw e})})})}}]),e}();
</script>

</body>

</html>